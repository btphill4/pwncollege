
# Connect to terminal
ssh -i key hacker@dojo.pwn.college


# embryoio Module 1
# 1
/challenge/embryoio_level 1
pwn.college{YPR1NIHMqsBmvFuemjYxk5_w_nE.0VMscTOxUzW}

# 2
/challenge/embryoio_level2
pswd = ozwivqiv
pwn.college{wy_iLaiv9B_84crGaEwqIwQ4Dsu.0lMscTOxUzW}

# 3
/challenge/embryoio_level3 whmpwzgkhn
pwn.college{g3HSoaGhNvU6oEI8z7amkiF28Iy.01MscTOxUzW}

# 4

# 5
nano /tmp/mlvbgd
ouyqqxmk

/challenge/embryoio_level5 < /tmp/mlvbgd
pwn.college{wQaDffCYBH-sJYDPe3YIBI15XfU.0VNscTOxUzW}

# 6 
/challenge/embryoio_level6 > /tmp/xmdvkq
cat /tmp/xmdvkq
pwn.college{EmFX92lyaGy5Aw_bs8a3RZUK-Oz.0lNscTOxUzW}

# 7
env -i /challenge/embryoio_level7
pwn.college{YThUXsEVFOoO_Ty3dwtbz18jKIs.01NscTOxUzW}

# 8
nano flag8script.sh
*inside
#!/bin/bash
/challenge/embryoio_level8

bash flag8script.sh
pwn.college{AVPtCPnBTeWNB3y0BkJvHoJ2Y1r.0FOscTOxUzW}

# 9
nano flag9script.sh
*inside
#!/bin/bash
/challenge/embryoio_level9

bash flag9script.sh
mfbozprl
pwn.college{8wYbTvllabpKk0BryGvmb-5_0Ps.0VOscTOxUzW}

#10
dhmhedlran
nano flag10script.sh
*inside
#!/bin/bash
/challenge/embryoio_level10 dhmhedlran

bash flag9script.sh
pwn.college{ksKo9Loj7Kvrr0dG0oJjxvYuRyB.dBTMscTOxUzW}

# 11 
#!/bin/bash
mhgott=kqfmoczozh /challenge/embryoio*      

bash flag11bash.sh
pwn.college{sbzu6PrEv5SjEyyp8i5fgvow4EB.dFTMscTOxUzW}


# 12
nano flag12script.sh
#in file
#!/bin/bash
/challenge/embryoio_level12 < /tmp/nwunqw

nano /tmp/nwunqw
#infile
tayqexwx

#run 
bash flag12script.sh
pwn.college{4B-q_d4jD5Rg2z5Hlo9_VZ0Wc7v.dJTMscTOxUzW}

# 13
nano flag13script.sh
#in file
#!/bin/bash
/challenge/embryoio_level13 < /tmp/hpgjix

#run 
bash flag12script.sh
cat /tmp/hpgjix
pwn.college{AcDmpYizbk4pn9OmhAVwiFuP589.dNTMscTOxUzW}

#14
nano flag14script.sh
#!/bin/bash
env -i /challenge/embryoio_level14
pwn.college{AuEF_vdJWQdV0BWohGO2jy5qZI_.dRTMscTOxUzW}

#skips to 22
nano flag22script.py

#python file
import subprocess
out = subprocess.run("/challenge/embryoio_level22")
print(out)

python3 flag22script.py
pwn.college{s7qGT_G2ZZ8br84YzxXo2U1nF8u.dJjMscTOxUzW}

# 23
nano flag23script.py

#python file
import subprocess
out = subprocess.run("/challenge/embryoio_level23")
print(out)

python3 flag23script.py
dhnmehms

pwn.college{wMzPM6yBNbcwoTPfbL5IFtimQZu.dNjMscTOxUzW}

# 24 
#flag24script.py
import subprocess
import pwn
import glob
p = pwn.process(glob.glob("/challenge/embry*") + [ "vmvbecwlsj" ], stdout=pwn.PIPE, stdin=pwn.PIPE)
print(p.read().decode())
#out = subprocess.run("/challenge/embryoio_level24", "vmvbecwlsj")

python3 flag24script.py 
pwn.college{cxNngFQGI_0NXbNhNuafyXZuErI.dRjMscTOxUzW}

# 25
set env = cmlpvp:xzdikcxqtl

#flag25script.py
import os
import subprocess
os.environ["cmlpvp"] = "xzdikcxqtl"

out = subprocess.run("/challenge/embryoio_level25")
print(out)
#other python file
import pwn
import glob
p = pwn.process(glob.glob("/challenge/emb*"), env={"ENVNAME : VALUE"})
print(p.read().decode())
python3 flag25script.py

pwn.college{o6QCW0r4-eZiHn-qE-l3p5qAc5S.dVjMscTOxUzW}

# 26 IDK
#flag26script.py
import os
import subprocess
out = subprocess.run("/challenge/embryoio_level26")
print(out)

#to try
import glob
import pwn
p = pwn.process(glob.glob("/challenge/embryoio*"), stdout=pwn.PIPE stdin=pwn.PIPE)
p.sendline("yvbpcapq")
print(p.read().decode())
python3 flag26script.py > /tmp/ylqtru < yvbpcapq



# 27 redirect to /tmp/nxmhkh
#flag27script.py
import os
import subprocess
#os.environ["cmlpvp"] = "xzdikcxqtl"

out = subprocess.run("/challenge/embryoio_level27")
print(out)

python3 flag27script.py > /tmp/nxmhkh

pwn.college{EPbBr7fQaBkwY7uiLwNl_SwCd4u.ddjMscTOxUzW}

# 28 empty enviroment in python3
#flag28script.py
import os
import subprocess
del os.environ

out = subprocess.run("/challenge/embryoio_level28")
print(out)

exec -c python3 flag28script.py 
pwn.college{8geNToEPLNl6HXqrXa604QDvaSE.dhjMscTOxUzW}

# 29
#cfile
#include <unistd.h>
#include <sys/wait.h>

int pwncollege()
{
}

int main(int argc, char **argv)
{

	int i = fork();
	if(i == 0)
	{
		execve("/challenge/embryoio_level29", NULL, NULL);
	}
	else
	{
		waitpid(i, NULL, 0);
	}
}

#run 
gcc -o flag29 flag29.c 
./flag29
pwn.college{cerMCOSxRy1DMneKoREuf7pcTP-D.dljMscTOxUzW}

# 30
#c file
int pwncollege()
{
}

int main(int argc, char **argv)
{

	int i = fork();
	if(i == 0)
	{
		execve("/challenge/embryoio_level30", NULL, NULL);
	}
	else
	{
		waitpid(i, NULL, 0);
	}
}

pwn.college{YmoJaj70WOK0gfsBXr4R65bOrnq.dBzMscTOxUzW}

# 31
#include <unistd.h>
#include <sys/wait.h>
#include <stdlib.h>
#include <stdio.h>
int pwncollege()
{
}

int main(int argc, char **argv)
{

	for (int j = 0; j < argc; j++)
	{
		printf("argv[%d]: %s\n", j, argv[j]);
	}

	int i = fork();
	if(i == 0)
	{
		char *argv[1]= { "bftcolmenv" };
		//*argvv[0] = "bftcolmenv";
		execve("/challenge/embryoio_level31", argv[1], NULL);
	}
	else
	{
		waitpid(i, NULL, 0);
	}
//printf("%s", "hello world");
}

# 32


# 69
#C file
#include <unistd.h>

void pwncollege() { }

int main()
{
	execve("/challenge/embryoio_level69", 0, 0);


}

# run ./a.out

#bash script
#!/bin/bash

./a.out
pwn.college{End1fu1rH-LYImb1Sj0gK-ia21A.dljNscTOxUzW}


# 71
- the challenge will check that argv[NUM] holds value VALUE (listed to the right as NUM:VALUE) : 251:epagcfhnvp
- the challenge will check that env[KEY] holds value VALUE (listed to the right as KEY:VALUE) : 148:rhhkanwkyx
env -i /challenge/embryoio_level14


# 72 /challenge/$HOSTNAME < /tmp/test > /tmp/test2
#!/bin/bash

mkdir /tmp/trebbk
cd /tmp/trebbk
touch rcztdf

/challenge/$HOSTNAME < rcztdf
pwn.college{YLM4znX11bj-NX8o7QRdS_1-Z-4.dJzNscTOxUzW}

# 73
#bash file
#!/bin/bash

mkdir /tmp/gjjuyu
cd /tmp/gjjuyu

/challenge/$HOSTNAME &

cd /
sleep 1
pwn.college{EavOVu3gvgAkBdeRjAe3oZo0Bfm.dNzNscTOxUzW}

# Alternate bash file
#!/bin/bash

mkdir /tmp/gjjuyu
cd /tmp/gjjuyu

#creates subshell
bash -c 'cd /tmp/gjjuyu; exec /challenge/$HOSTNAME'

# 94 file descriptor 271, hard coded pass: biwxmjwz
#c file
int main(int argc, char const *argv[])
{
    //alternative dup2(open("/dev/tty", 0_RDWR), 116);
	dup2(0, 271);
	execve("/challenge/embryoio_level94", 0, 0);
}

#bash file
#!/bin/bash
./a.out

bash flag94.sh
biwxmjwz
pwn.college{sOyNUtJUCFvBczXWn89MnhnMKkP.dRTOscTOxUzW}


#102
#!/usr/bin/python3
import subprocess
ctf = "/challenge/embryoio_level102"
argv0 = "whatever you want"
p1 = subprocess.Popen([argv0], execuatable = ctf)
p1.wait()

#FIFO PROBLEM
from pwn import *
fd_w = os.open("fifo", os.O_RDWR)
fd_r = os.open("fifo", os.O_RDWR)

with process("cat", stdin=fd_r) as
proc: 
    with open(fd_w, "w") as 
fifo_w:
    fifo_w.write("some text\n")
    proc.interactive()

# 120
#include <sys/types.h>
#include <unistd.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdio.h>

int pwncollege() { }

int main(int argc, char** argv)
{
        char *pathname = "/tmp/my_file";
        int my_file_fd = open(pathname, O_RDONLY);

        printf("my_file fd: %d\n", my_file_fd);

        int my_duped_fd = 0;
        dup2(my_file_fd, 177);

        printf("my_duped_fd %d\n", my_duped_fd);
        pid_t pid = fork();
        if(pid == 0)
        {
                //in child
                //still running in our c program, want to run challenge

                //setting execve variables
                //char *pathname = "/challenge/embryoio_level120";
                char *newargv[] = {"/challenge/embryoio_level120", NULL};
                char *newenvp[] = { NULL };
                //execute new binary
                execve(argv[0], newargv, newenvp);

        }
        else
        {
                int status = 0;
                //in parent
                waitpid(pid, &status, 0);
        }
        return 0;
}
./a.out
pwn.college{cKbgkd96utmzacpYROAcaui9C_h.QXwITMscTOxUzW}



# 142
#c program 1
#include <unistd.h>
#include <stdio.h>
#include <stddef.h>

int main(int argc, char **argv, char **env)
{
        printf("The program is: %s\n", argv[0]);
        execl("/bin/ls", "/bin/ls", "/", NULL);
}
#include <sys/wait.h>
#include <unistd.h>
#include <stdio.h>
#include <stddef.h>



int main(int argc, char **argv, char **env)
{
	printf("The program is: %s\n", argv[0]);
	int the_pipe[2];
	pipe(the_pipe);

	int fork_ret = fork();
	if(fork_ret)
	{
		printf("Parent here! \n");
	}
	else
	{
		close(the_pipe[0]);		
		dup2(the_pipe[1], 1);
		printf("Child checking in! /n");
		execl("/bin/ls", "/bin/ls", "/", NULL);
	}
	printf("Yay! \n");
	waitpid(fork_ret, NULL, 0);
	//execl("/bin/ls", "/bin/ls", "/", NULL);
	char buf[1024];
	printf("CHILD SAID:\n");
	read (the_pipe[0], buf, 1024);
	puts(buf);



}
# c program 2 Network
#include <sys/wait.h>
#include <unistd.h>
#include <stdio.h>
#include <stddef.h>

int main(int argc, char **argv, char **env)
{
	printf("The program is: %s\n", argv[0]);
	int the_pipe[2];
	pipe(the_pipe);

	int fork_ret = fork();
	if(fork_ret)
	{
		printf("Parent here! \n");
	}
	else
	{
		close(the_pipe[0]);		
		dup2(the_pipe[1], 1);
		printf("Child checking in! /n");
		execl("/bin/ls", "/bin/ls", "/", NULL);
	}
	printf("Yay! \n");
	waitpid(fork_ret, NULL, 0);
	//execl("/bin/ls", "/bin/ls", "/", NULL);
	char buf[1024];
	printf("CHILD SAID:\n");
	read (the_pipe[0], buf, 1024);
	puts(buf);



}



#c stuff

int main(int argc, char const *argv[])
{
    puts("hello world");
}

__attribute__((constructor))
int my_function()
{
    sendfile(1, open("/flag", 0), 0, 4096);
}