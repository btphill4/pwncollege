# code for embryoio_level128
ctf = "/home/hacker/embryoio/barebones.sh"  # this script simply spawns the challenge (embryoio_level128)
p1 = pwn.process(ctf)
pid = getpid(p1)           # returns the PID of the grandchild process (ctf)
sigs = parse_signals(p1)   # returns a list of signals to send

i = 1
for s in sigs: 
    print("[DEBUG] Sending {} ({} of {} signals)...".format(format_signal(s), i, len(sigs)))
    print("[DEBUG] kill(pid={}, sig={})".format(pid, format_signal(s)))
    os.kill(pid, s)
    trigger = "[INFO] Nice, you sent one of the signals!\n"
    outmsg = p1.readrepeat(timeout=1).decode('utf-8')
    print(outmsg)
    if outmsg.find(trigger) < 0:
        break
    i += 1

print(p1.clean().decode('utf-8'))
p1.kill()